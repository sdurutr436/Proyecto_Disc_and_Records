{
  "version": 3,
  "sources": ["src/app/components/shared/modal/modal.ts", "src/app/components/shared/modal/modal.html"],
  "sourcesContent": ["import { Component, signal, input, output, HostListener, effect } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n@Component({\r\n  selector: 'app-modal',\r\n  imports: [CommonModule],\r\n  templateUrl: './modal.html',\r\n  styleUrl: './modal.scss',\r\n})\r\nexport class Modal {\r\n  /**\r\n   * Señal para controlar si el modal está abierto.\r\n   * Se puede pasar desde el componente padre.\r\n   */\r\n  isOpen = input<boolean>(false);\r\n\r\n  /**\r\n   * Título del modal (opcional)\r\n   */\r\n  title = input<string>('');\r\n\r\n  /**\r\n   * Evento que se emite cuando el modal se cierra\r\n   */\r\n  onClose = output<void>();\r\n\r\n  /**\r\n   * Signal interna para controlar animaciones\r\n   */\r\n  isVisible = signal(false);\r\n\r\n  /**\r\n   * Flag para distinguir cierre por usuario vs cierre por input\r\n   */\r\n  private closedByUser = false;\r\n\r\n  constructor() {\r\n    // Sincronizar isVisible con isOpen usando effect\r\n    effect(() => {\r\n      if (this.isOpen()) {\r\n        this.open();\r\n      } else {\r\n        // Cierre por cambio de input, no emitir evento\r\n        this.closeWithoutEmit();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Abrir modal\r\n   */\r\n  open() {\r\n    this.isVisible.set(true);\r\n    this.closedByUser = false;\r\n    // Prevenir scroll del body cuando el modal está abierto\r\n    document.body.style.overflow = 'hidden';\r\n  }\r\n\r\n  /**\r\n   * Cerrar modal (por acción del usuario)\r\n   */\r\n  close() {\r\n    this.isVisible.set(false);\r\n    // Restaurar scroll del body\r\n    document.body.style.overflow = '';\r\n    // Emitir evento de cierre al padre\r\n    this.onClose.emit();\r\n  }\r\n\r\n  /**\r\n   * Cerrar modal sin emitir evento (por cambio de input)\r\n   */\r\n  private closeWithoutEmit() {\r\n    this.isVisible.set(false);\r\n    document.body.style.overflow = '';\r\n  }\r\n\r\n  /**\r\n   * Cerrar al hacer click en el overlay (fuera del contenido)\r\n   */\r\n  onOverlayClick(event: MouseEvent) {\r\n    const target = event.target as HTMLElement;\r\n    // Solo cerrar si el click fue directamente en el overlay, no en el contenido\r\n    if (target.classList.contains('modal__overlay')) {\r\n      this.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Cerrar modal al presionar ESC\r\n   */\r\n  @HostListener('document:keydown.escape')\r\n  onEscapeKey() {\r\n    if (this.isVisible()) {\r\n      this.close();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Trap focus: prevenir que el foco salga del modal\r\n   */\r\n  @HostListener('keydown', ['$event'])\r\n  onKeydown(event: KeyboardEvent) {\r\n    if (!this.isVisible() || event.key !== 'Tab') return;\r\n\r\n    const modalElement = document.querySelector('.modal__content');\r\n    if (!modalElement) return;\r\n\r\n    const focusableElements = modalElement.querySelectorAll(\r\n      'a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex=\"-1\"])'\r\n    );\r\n\r\n    const firstElement = focusableElements[0] as HTMLElement;\r\n    const lastElement = focusableElements[focusableElements.length - 1] as HTMLElement;\r\n\r\n    // Si Shift+Tab en el primer elemento, ir al último\r\n    if (event.shiftKey && document.activeElement === firstElement) {\r\n      event.preventDefault();\r\n      lastElement?.focus();\r\n    }\r\n    // Si Tab en el último elemento, ir al primero\r\n    else if (!event.shiftKey && document.activeElement === lastElement) {\r\n      event.preventDefault();\r\n      firstElement?.focus();\r\n    }\r\n  }\r\n}\r\n", "<!-- Template reutilizable para el icono de cerrar -->\r\n<ng-template #closeIcon>\r\n  <svg\r\n    width=\"24\"\r\n    height=\"24\"\r\n    viewBox=\"0 0 24 24\"\r\n    fill=\"none\"\r\n    stroke=\"currentColor\"\r\n    stroke-width=\"2\"\r\n    stroke-linecap=\"round\"\r\n    stroke-linejoin=\"round\">\r\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\r\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\r\n  </svg>\r\n</ng-template>\r\n\r\n<!-- Modal overlay: sólo visible cuando isVisible() es true -->\r\n@if (isVisible()) {\r\n<div\r\n  class=\"modal__overlay\"\r\n  (click)=\"onOverlayClick($event)\"\r\n  role=\"dialog\"\r\n  aria-modal=\"true\"\r\n  [attr.aria-labelledby]=\"title() ? 'modal-title' : null\">\r\n\r\n  <!-- Contenido del modal -->\r\n  <div class=\"modal__content\">\r\n    <!-- Header del modal (solo si hay título) -->\r\n    @if (title()) {\r\n    <div class=\"modal__header\">\r\n      <h2\r\n        id=\"modal-title\"\r\n        class=\"modal__title\">\r\n        {{ title() }}\r\n      </h2>\r\n      <button\r\n        class=\"modal__close\"\r\n        (click)=\"close()\"\r\n        aria-label=\"Cerrar modal\"\r\n        type=\"button\">\r\n        <ng-container *ngTemplateOutlet=\"closeIcon\"></ng-container>\r\n      </button>\r\n    </div>\r\n    }\r\n    <!-- Botón cerrar flotante (cuando no hay header) -->\r\n    @if (!title()) {\r\n    <button\r\n      class=\"modal__close modal__close--floating\"\r\n      (click)=\"close()\"\r\n      aria-label=\"Cerrar modal\"\r\n      type=\"button\">\r\n      <ng-container *ngTemplateOutlet=\"closeIcon\"></ng-container>\r\n    </button>\r\n    }\r\n\r\n    <!-- Body del modal: contenido dinámico proyectado -->\r\n    <div class=\"modal__body\">\r\n      <ng-content></ng-content>\r\n    </div>\r\n\r\n    <!-- Footer del modal (opcional) -->\r\n    <div class=\"modal__footer\">\r\n      <ng-content select=\"[modal-footer]\"></ng-content>\r\n    </div>\r\n  </div>\r\n</div>\r\n}\r\n"],
  "mappings": "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",
  "names": []
}
