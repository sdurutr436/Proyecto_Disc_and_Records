import{U as n,d as o,hc as a,k as i,ma as s}from"./chunk-7KKLOBFE.js";var l=class r{activeOperations=s(0);loadingMessage=s("Cargando...");currentProgress=s(-1);isLoading=a(()=>this.activeOperations()>0);message=a(()=>this.loadingMessage());progress=a(()=>this.currentProgress());localStates=new Map;localStatesSubject=new i(new Map);localStates$=this.localStatesSubject.asObservable();start(e="Cargando..."){this.activeOperations.update(t=>t+1),this.loadingMessage.set(e),this.currentProgress.set(-1)}stop(){this.activeOperations.update(e=>Math.max(0,e-1)),this.activeOperations()===0&&this.currentProgress.set(-1)}stopAll(){this.activeOperations.set(0),this.currentProgress.set(-1),this.localStates.clear(),this.localStatesSubject.next(new Map)}setProgress(e){this.currentProgress.set(Math.min(100,Math.max(0,e)))}incrementProgress(e){let t=this.currentProgress();t>=0&&this.setProgress(t+e)}startLocal(e){this.localStates.set(e,!0),this.localStatesSubject.next(new Map(this.localStates))}stopLocal(e){this.localStates.set(e,!1),this.localStatesSubject.next(new Map(this.localStates))}isLocalLoading(e){return this.localStates.get(e)??!1}clearLocal(e){this.localStates.delete(e),this.localStatesSubject.next(new Map(this.localStates))}withLoading(e,t){return o(this,null,function*(){this.start(t);try{return yield e}finally{this.stop()}})}withLocalLoading(e,t){return o(this,null,function*(){this.startLocal(e);try{return yield t}finally{this.stopLocal(e)}})}static \u0275fac=function(t){return new(t||r)};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
