<div class="home">
  <!-- ============================================ -->
  <!-- SECCI칍N HERO: Backdrop con Im치genes por Tema -->
  <!-- ============================================ -->
  <section
    class="home__hero"
    [class.home__hero--dark]="isDarkMode"
    [class.home__hero--grayscale]="isGrayscale"
  >
    <!-- Contenedor de la imagen hero - LCP element -->
    <div class="home__hero-image-container">
      <!-- Imagen responsive con srcset optimizada para LCP -->
      <picture class="home__hero-picture">
        <source
          media="(max-width: 479px)"
          [srcset]="currentHero.srcSmall"
          type="image/webp"
        />
        <source
          media="(min-width: 480px) and (max-width: 767px)"
          [srcset]="currentHero.srcMedium"
          type="image/webp"
        />
        <source
          media="(min-width: 768px) and (max-width: 1199px)"
          [srcset]="currentHero.srcLarge"
          type="image/webp"
        />
        <source
          media="(min-width: 1200px)"
          [srcset]="currentHero.srcExtraLarge"
          type="image/webp"
        />
        <img
          class="home__hero-image"
          [src]="currentHero.srcSmall"
          [srcset]="currentHero.srcSmall + ' 480w, ' + currentHero.srcMedium + ' 768w, ' + currentHero.srcLarge + ' 1200w, ' + currentHero.srcExtraLarge + ' 1920w'"
          sizes="100vw"
          [alt]="currentHero.alt"
          aria-describedby="hero-description"
          width="1200"
          height="800"
          loading="eager"
          decoding="sync"
          fetchpriority="high"
        />
      </picture>
    </div>
    <span id="hero-description" hidden>
      Imagen decorativa de fondo que muestra la silueta de un artista m칰sical. Forma parte del dise침o visual de la p치gina de inicio de Discs &amp; Records.
    </span>

    <!-- Contenido del hero -->
    <div class="home__hero-content">
      @if (isAuthenticated) {
        <!-- Usuario autenticado - Saludo personalizado -->
        <h1 class="home__slogan animate-fade-in-up">
          춰Hola, {{ currentUserName }}!
          <span class="home__slogan-highlight">{{ motivationalPhrase() }}</span>
        </h1>
      } @else {
        <!-- Usuario no autenticado - CTA de registro -->
        <h1 class="home__slogan animate-fade-in-up">
          Punt칰a todos tus 치lbumes favoritos
          <span class="home__slogan-highlight">en un solo lugar</span>
        </h1>

        <!-- Bot칩n de llamada a la acci칩n -->
        <app-button
          variant="primary"
          size="lg"
          (clicked)="openRegisterModal()"
          class="home__cta-button animate-fade-in-up"
        >
          COMIENZA AQU칈
        </app-button>
      }
    </div>
  </section>

  <!-- ============================================ -->
  <!-- SECCI칍N DE B칔SQUEDA                          -->
  <!-- ============================================ -->
  <section class="home__search" role="search" aria-label="Buscar 치lbumes y artistas">
    <app-search-bar
      (onSearch)="handleSearch($event)"
    ></app-search-bar>
  </section>

  <!-- ============================================ -->
  <!-- CARRUSEL: 츼LBUMES EN TENDENCIA               -->
  <!-- ============================================ -->
  <section class="home__section" aria-labelledby="trending-title">
    @if (isLoading()) {
      <!-- Estado de carga para el carrusel -->
      <div class="home__carousel-loading" aria-live="polite" aria-label="Cargando 치lbumes en tendencia">
        <h2 id="trending-title" class="home__carousel-title">칔LTIMOS 츼LBUMES EN TENDENCIA</h2>
        <div class="home__spinner-container">
          <app-spinner mode="inline" size="lg" aria-hidden="true"></app-spinner>
          <p class="home__loading-text" role="status">Cargando 치lbumes...</p>
        </div>
      </div>
    } @else {
      <app-carousel title="칔LTIMOS 츼LBUMES EN TENDENCIA" titleId="trending-title">
        @for (album of trendingAlbums(); track album.id) {
          <app-card
            [title]="album.title"
            [titleLink]="'/album/' + album.id"
            [subtitle]="album.artist"
            [subtitleLink]="'/artist/' + album.artist"
            [imageUrl]="album.imageUrl"
            [imageAlt]="album.title + ' por ' + album.artist"
            variant="vinilo"
            cardType="polaroid"
            hoverEffect="lift"
            (click)="viewAlbumDetails(album.id)"
            class="home__album-card"
          >
            <!-- Badge de rating si est치 disponible -->
            @if (album.rating) {
              <div class="home__rating">
                <app-rating [rating]="album.rating" [showValue]="true" size="small" />
              </div>
            }
          </app-card>
        }
      </app-carousel>
    }
  </section>

  <!-- ============================================ -->
  <!-- CARRUSEL: 츼LBUMES RESE칌ADOS                  -->
  <!-- ============================================ -->
  <section class="home__section" aria-labelledby="reviewed-title">
    @if (isLoading()) {
      <!-- Estado de carga para el carrusel -->
      <div class="home__carousel-loading" aria-live="polite" aria-label="Cargando 치lbumes rese침ados">
        <h2 id="reviewed-title" class="home__carousel-title">칔LTIMOS 츼LBUMES RESE칌ADOS</h2>
        <div class="home__spinner-container">
          <app-spinner mode="inline" size="lg" aria-hidden="true"></app-spinner>
          <p class="home__loading-text" role="status">Cargando 치lbumes...</p>
        </div>
      </div>
    } @else {
      <app-carousel title="칔LTIMOS 츼LBUMES RESE칌ADOS" titleId="reviewed-title">
        @for (album of recentReviews(); track album.id) {
          <app-card
            [title]="album.title"
            [titleLink]="'/album/' + album.id"
            [subtitle]="album.artist"
            [subtitleLink]="'/artist/' + album.artist"
            [imageUrl]="album.imageUrl"
            [imageAlt]="album.title + ' por ' + album.artist"
            variant="vinilo"
            cardType="polaroid"
            hoverEffect="lift"
            (click)="viewAlbumDetails(album.id)"
            class="home__album-card"
          >
            <!-- Badge de n칰mero de rese침as -->
            @if (album.reviewCount) {
              <div class="home__reviews">
                游눫 {{ album.reviewCount }} rese침as
              </div>
            }
          </app-card>
        }
      </app-carousel>
    }
  </section>

  <!-- ============================================ -->
  <!-- CARRUSEL: MIS 칔LTIMOS RESE칌ADOS (Solo auth)  -->
  <!-- ============================================ -->
  @if (isAuthenticated && myReviewedAlbums().length > 0) {
    <section class="home__section home__section--personal" aria-labelledby="my-reviews-title">
      <app-carousel title="MIS 칔LTIMOS 츼LBUMES RESE칌ADOS" titleId="my-reviews-title">
        @for (album of myReviewedAlbums(); track album.id) {
          <app-card
            [title]="album.title"
            [titleLink]="'/album/' + album.id"
            [subtitle]="album.artist"
            [subtitleLink]="'/artist/' + album.artist"
            [imageUrl]="album.imageUrl"
            [imageAlt]="album.title + ' por ' + album.artist"
            variant="vinilo"
            cardType="polaroid"
            hoverEffect="lift"
            (click)="viewAlbumDetails(album.id)"
            class="home__album-card"
          >
            <!-- Badge de mi rating -->
            @if (album.rating) {
              <div class="home__rating home__rating--personal">
                <app-rating [rating]="album.rating" [showValue]="true" size="small" />
              </div>
            }
          </app-card>
        }
      </app-carousel>
    </section>
  }
</div>
