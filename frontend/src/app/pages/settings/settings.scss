@use '../../../styles/00-settings/variables' as vars;
@use '../../../styles/01-tools/mixins' as mixins;

.settings {
  min-height: 100vh;
  padding: vars.$espaciado-l 0;

  /* ========================================
     CONTAINER
     ======================================== */
  &__container {
    max-width: vars.$ancho-maximo-contenedor;
    margin: 0 auto;
    padding: 0 vars.$espaciado-m;

    @include mixins.respond-to('mobile') {
      padding: 0 vars.$espaciado-s;
    }
  }

  /* ========================================
     LAYOUT: SIDEBAR + CONTENT
     ======================================== */
  &__layout {
    display: grid;
    grid-template-columns: vars.$ancho-maximo-card 1fr;
    gap: vars.$espaciado-xl;
    margin-top: vars.$espaciado-l;

    @include mixins.respond-to('tablet') {
      grid-template-columns: 1fr;
      gap: vars.$espaciado-m;
    }
  }

  /* ========================================
     SIDEBAR
     ======================================== */
  &__sidebar {
    position: sticky;
    top: calc(vars.$espaciado-l + vars.$espaciado-xxl);
    height: fit-content;
    padding: vars.$espaciado-l;
    padding-left: 0;
    padding-top: 0;
    background-color: var(--bg-primary);
    border-right: vars.$borde-brutal-thick;
    border-bottom: vars.$borde-brutal-thick;
    box-shadow: none;

    @include mixins.respond-to('tablet') {
      position: static;
      padding: vars.$espaciado-m;
      border: vars.$borde-brutal-thick;
      box-shadow: vars.$sombra-brutal-m;
    }
  }

  &__title {
    @include mixins.font-size-line('h2');
    font-weight: 900;
    color: var(--text-dark);
    margin: 0 0 vars.$espaciado-l 0;
    text-transform: uppercase;
    letter-spacing: -0.02em;

    @include mixins.respond-to('mobile') {
      @include mixins.font-size-line('h3');
    }
  }

  /* ========================================
     NAVEGACIÓN DE TABS
     ======================================== */
  &__nav {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-xs;
  }

  &__nav-item {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: vars.$espaciado-s vars.$espaciado-m;
    background-color: var(--bg-primary);
    border: vars.$borde-brutal-thin;
    cursor: pointer;
    transition: all vars.$transicion-rapida;
    font-weight: 600;
    text-decoration: none;
    color: var(--text-dark);
    @include mixins.font-size-line('texto-pequeno-m');

    &:hover {
      background-color: var(--bg-secondary);
      transform: translateX(0.25rem);
      box-shadow: vars.$sombra-brutal-s;
    }

    &--active {
      background-color: var(--color-primary);
      color: var(--bg-primary);
      border-color: var(--text-dark);
      transform: translateX(0.25rem);
      box-shadow: vars.$sombra-brutal-s;
    }
  }

  &__sidebar-footer {
    margin-top: vars.$espaciado-l;
    padding-top: vars.$espaciado-m;
    border-top: vars.$borde-brutal-thin;
  }

  &__back-link {
    display: inline-flex;
    align-items: center;
    gap: vars.$espaciado-xs;
    color: var(--text-secondary);
    text-decoration: none;
    font-weight: 600;
    @include mixins.font-size-line('texto-pequeno-m');
    transition: all vars.$transicion-rapida;

    &:hover {
      color: var(--color-primary);
      transform: translateX(-0.25rem);
    }
  }

  /* ========================================
     CONTENIDO
     ======================================== */
  &__content {
    animation: fadeIn vars.$transicion-base ease;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-0.625rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ========================================
     TABS (SECCIONES)
     ======================================== */
  &__tab {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-l;
  }

  &__tab-header {
    padding-bottom: vars.$espaciado-m;
    border-bottom: vars.$borde-brutal-thin;
  }

  &__tab-title {
    @include mixins.font-size-line('h2');
    font-weight: 900;
    color: var(--text-dark);
    margin: 0 0 vars.$espaciado-xs 0;
  }

  &__tab-description {
    @include mixins.font-size-line('texto-normal');
    color: var(--text-secondary);
    margin: 0;
  }

  /* ========================================
     MENSAJES DE ESTADO
     ======================================== */
  &__message {
    @include mixins.font-size-line('texto-normal');
    padding: vars.$espaciado-m;
    margin-bottom: vars.$espaciado-m;
    border: vars.$borde-brutal-thick;
    font-weight: 600;
    animation: slideDown vars.$transicion-base ease;

    &--success {
      background-color: color-mix(in srgb, var(--color-success) 10%, transparent);
      border-color: var(--color-success);
      color: var(--color-success);
    }

    &--error {
      background-color: color-mix(in srgb, var(--color-error) 10%, transparent);
      border-color: var(--color-error);
      color: var(--color-error);
    }
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-0.625rem);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ========================================
     SEPARADORES
     ======================================== */
  &__divider {
    height: 0.125rem;
    background-color: var(--border-color);
    border: none;
    margin: vars.$espaciado-l 0;

    &--small {
      margin: vars.$espaciado-m 0;
    }
  }

  /* ========================================
     SECCIONES
     ======================================== */
  &__section {
    display: flex;
    flex-direction: column;
  }

  /* ========================================
     FOTO DE PERFIL
     ======================================== */
  &__avatar-section {
    display: flex;
    gap: vars.$espaciado-m;
    align-items: center;

    @include mixins.respond-to('tablet') {
      flex-direction: column;
      text-align: center;
    }
  }

  &__avatar-preview {
    flex-shrink: 0;
  }

  &__avatar-image {
    width: vars.$espaciado-xxl * 3;
    height: vars.$espaciado-xxl * 3;
    object-fit: cover;
    border: vars.$borde-brutal-thick;
    box-shadow: vars.$sombra-brutal-m;
    background-color: var(--bg-secondary);

    @include mixins.respond-to('tablet') {
      width: calc(vars.$espaciado-xxl * 2.4);
      height: calc(vars.$espaciado-xxl * 2.4);
    }
  }

  &__avatar-actions {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-s;
  }

  &__avatar-info {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-s;
  }

  &__avatar-label {
    cursor: pointer;
  }

  &__avatar-input {
    display: none;
  }

  &__avatar-hint {
    @include mixins.font-size-line('texto-pequeno-m');
    color: var(--text-muted);
    margin: 0;
  }

  /* ========================================
     FORMULARIOS
     ======================================== */
  &__form {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-m;
    width: 100%;
  }

  &__form-actions {
    display: flex;
    gap: vars.$espaciado-s;
    justify-content: flex-start;
    margin-top: vars.$espaciado-s;

    @include mixins.respond-to('mobile') {
      flex-direction: column;

      app-button {
        width: 100%;
      }
    }
  }

  &__field-hint {
    @include mixins.font-size-line('texto-pequeno-s');
    color: var(--text-muted);
    margin: vars.$espaciado-xs 0;
  }

  /* ========================================
     REQUISITOS DE CONTRASEÑA
     ======================================== */
  &__password-requirements {
    padding: vars.$espaciado-m;
    background-color: var(--bg-secondary);
    border: vars.$borde-brutal-thin;
    border-radius: 0;
  }

  &__requirements-title {
    @include mixins.font-size-line('texto-pequeno-m');
    font-weight: 600;
    color: var(--text-dark);
    margin: 0 0 vars.$espaciado-s 0;
  }

  &__requirements-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-xs;

    li {
      @include mixins.font-size-line('texto-pequeno-m');
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: vars.$espaciado-xs;
      transition: color 0.2s ease;

      &.settings__requirement--met {
        color: var(--color-success);
        font-weight: 600;
      }
    }
  }

  &__requirement-icon {
    font-weight: bold;
    width: vars.$icono-s;
    text-align: center;
  }

  /* ========================================
     PREFERENCIAS
     ======================================== */
  &__preferences {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-m;
  }

  &__preference-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: vars.$espaciado-m;
    padding-bottom: vars.$espaciado-m;
    border-bottom: vars.$borde-brutal-thin;

    &:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    &--full {
      flex-direction: column;
      align-items: stretch;
    }
  }

  &__preference-info {
    flex: 1;
  }

  &__preference-title {
    @include mixins.font-size-line('texto-normal');
    font-weight: 600;
    color: var(--text-dark);
    margin: 0 0 vars.$espaciado-xs 0;
  }

  &__preference-desc {
    @include mixins.font-size-line('texto-pequeno-m');
    color: var(--text-secondary);
    margin: 0;
  }

  /* ========================================
     TOGGLE SWITCH
     ======================================== */
  &__toggle {
    position: relative;
    display: inline-block;
    width: calc(vars.$espaciado-xxl + vars.$espaciado-s);
    height: calc(vars.$espaciado-m + vars.$espaciado-xs);
    flex-shrink: 0;

    input {
      opacity: 0;
      width: 0;
      height: 0;

      &:checked + .settings__toggle-slider {
        background-color: var(--color-primary);

        &::before {
          transform: translateX(calc(vars.$espaciado-m + vars.$espaciado-xs));
        }
      }

      &:focus + .settings__toggle-slider {
        box-shadow: 0 0 0 0.1875rem color-mix(in srgb, var(--color-primary) 20%, transparent);
      }
    }
  }

  &__toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: var(--text-muted);
    transition: vars.$transicion-base;
    border: vars.$borde-brutal-thin;

    &::before {
      position: absolute;
      content: '';
      height: vars.$espaciado-m;
      width: vars.$espaciado-m;
      left: vars.$espaciado-xs;
      bottom: vars.$espaciado-xs;
      background-color: var(--bg-primary);
      transition: vars.$transicion-base;
      border: 0.125rem solid var(--text-dark);
    }
  }

  /* ========================================
     RADIO BUTTONS
     ======================================== */
  &__radio-group {
    display: flex;
    gap: vars.$espaciado-s;
    flex-wrap: wrap;
  }

  &__radio {
    display: flex;
    align-items: center;
    gap: vars.$espaciado-xs;
    cursor: pointer;
    padding: vars.$espaciado-s vars.$espaciado-m;
    border: vars.$borde-brutal-thin;
    background-color: var(--bg-primary);
    transition: all vars.$transicion-rapida;

    &:hover {
      background-color: var(--bg-secondary);
      transform: translateY(-0.125rem);
      box-shadow: vars.$sombra-brutal-s;
    }

    input[type='radio'] {
      appearance: none;
      width: vars.$icono-s;
      height: vars.$icono-s;
      border: 0.1875rem solid var(--text-dark);
      background-color: var(--bg-primary);
      cursor: pointer;
      position: relative;

      &:checked {
        background-color: var(--color-primary);
        border-color: var(--text-dark);

        &::after {
          content: '';
          position: absolute;
          width: vars.$espaciado-xs;
          height: vars.$espaciado-xs;
          background-color: var(--text-dark);
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
      }
    }
  }

  &__radio-label {
    @include mixins.font-size-line('texto-pequeno-m');
    font-weight: 600;
    color: var(--text-dark);
  }

  /* ========================================
     INFORMACIÓN DE SEGURIDAD
     ======================================== */
  &__security-info {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-m;
  }

  &__info-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: vars.$espaciado-m;
    background-color: var(--bg-secondary);
    border: vars.$borde-brutal-thin;

    @include mixins.respond-to('mobile') {
      flex-direction: column;
      align-items: flex-start;
      gap: vars.$espaciado-xs;
    }
  }

  &__info-label {
    @include mixins.font-size-line('texto-pequeno-m');
    font-weight: 600;
    color: var(--text-secondary);
  }

  &__info-value {
    @include mixins.font-size-line('texto-normal');
    color: var(--text-dark);
    font-weight: 600;
  }

  /* ========================================
     ZONA DE PELIGRO
     ======================================== */
  &__section--danger {
    border: 0.1875rem solid var(--color-error);
    padding: vars.$espaciado-m;
    background-color: color-mix(in srgb, var(--color-error) 5%, transparent);
  }

  &__danger-zone {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: vars.$espaciado-m;

    @include mixins.respond-to('tablet') {
      flex-direction: column;
      align-items: stretch;
    }
  }

  &__danger-info {
    flex: 1;
  }

  &__danger-title {
    @include mixins.font-size-line('texto-normal');
    font-weight: 700;
    color: var(--color-error);
    margin: 0 0 vars.$espaciado-xs 0;
  }

  &__danger-desc {
    @include mixins.font-size-line('texto-pequeno-m');
    color: var(--text-secondary);
    margin: 0;
  }

  &__danger-button {
    flex-shrink: 0;
  }

  /* ========================================
     MODALES
     ======================================== */
  &__modal-content {
    display: flex;
    flex-direction: column;
    gap: vars.$espaciado-m;
  }

  &__modal-text {
    @include mixins.font-size-line('texto-normal');
    color: var(--text-primary);
    margin: 0;

    &--warning {
      color: var(--color-error);
      font-weight: 700;
      @include mixins.font-size-line('h4');
    }
  }

  &__modal-list {
    list-style: none;
    padding: 0 0 0 vars.$espaciado-m;
    margin: 0;

    li {
      @include mixins.font-size-line('texto-normal');
      color: var(--text-secondary);
      margin-bottom: vars.$espaciado-xs;
      position: relative;

      &::before {
        content: '•';
        position: absolute;
        left: calc(vars.$espaciado-m * -1);
        color: var(--color-primary);
        font-weight: bold;
      }
    }
  }

  &__modal-actions {
    display: flex;
    gap: vars.$espaciado-s;
    justify-content: flex-end;

    @include mixins.respond-to('mobile') {
      flex-direction: column-reverse;
    }
  }

  /* ========================================
     FOOTER
     ======================================== */
  &__back-button {
    display: flex;
    justify-content: center;
    padding-top: vars.$espaciado-xl;
    margin-top: vars.$espaciado-xl;
    border-top: vars.$borde-brutal-thin;
  }

  &__footer {
    display: flex;
    justify-content: center;
    gap: vars.$espaciado-s;
    padding-top: vars.$espaciado-m;
    border-top: vars.$borde-brutal-thin;
  }
}
