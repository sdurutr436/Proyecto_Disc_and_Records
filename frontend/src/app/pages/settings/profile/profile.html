<div class="settings-profile">
  <!-- Mensajes de estado con componentes Alert -->
  @if (successMessage()) {
    <app-alert
      type="success"
      [message]="successMessage()!"
      [dismissible]="true"
      (dismissed)="successMessage.set(null)"
    />
  }
  @if (errorMessage()) {
    <app-alert
      type="error"
      [message]="errorMessage()!"
      [dismissible]="true"
      (dismissed)="errorMessage.set(null)"
    />
  }

  <header class="settings-profile__header">
    <h2 class="settings-profile__title">Información del Perfil</h2>
    <p class="settings-profile__subtitle">Personaliza cómo te ven los demás usuarios</p>
  </header>

  <!-- Foto de perfil -->
  <section class="settings-profile__section">
    <h3 class="settings-profile__section-title">Foto de Perfil</h3>
    <div class="settings-profile__avatar">
      <div class="settings-profile__avatar-preview">
        <img [src]="currentAvatar()" alt="Avatar actual" class="settings-profile__avatar-image" />
      </div>
      <div class="settings-profile__avatar-info">
        <label for="avatar-upload" class="settings-profile__avatar-label">
          <app-button
            variant="secondary"
            type="button"
            [disabled]="isLoading()"
          >
            Cambiar Foto
          </app-button>
        </label>
        <input
          id="avatar-upload"
          type="file"
          accept="image/*"
          (change)="onAvatarChange($event)"
          class="settings-profile__avatar-input"
        />
        <p class="settings-profile__hint">JPG, PNG o GIF. Máximo 2MB.</p>
      </div>
    </div>
  </section>

  <!-- Nombre de usuario -->
  <section class="settings-profile__section">
    <h3 class="settings-profile__section-title">Nombre de Usuario</h3>
    <form [formGroup]="profileForm" class="settings-profile__form">
      <app-form-input
        [control]="profileForm.controls.username"
        label="Usuario"
        type="text"
        placeholder="Ingresa tu nombre de usuario"
        [required]="true"
        hint="Solo letras, números y guiones bajos. Mínimo 3 caracteres."
      />

      <div class="settings-profile__actions">
        <app-button
          variant="primary"
          type="button"
          [disabled]="profileForm.controls.username.invalid || isLoading()"
          (click)="onSubmit()"
        >
          Guardar Cambios
        </app-button>
      </div>
    </form>
  </section>
</div>
