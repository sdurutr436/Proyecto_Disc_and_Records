<main class="profile">
  <div class="profile__container">
    <!-- ============================================ -->
    <!-- COLUMNA IZQUIERDA: Card de Perfil (1/3)      -->
    <!-- ============================================ -->
    <aside class="profile__sidebar">
      <app-card
        [title]="userProfile.name"
        [subtitle]="'Miembro desde ' + userProfile.memberSince"
        [imageUrl]="userProfile.avatarUrl"
        [imageAlt]="'Avatar de ' + userProfile.name"
        cardType="profile"
        variant="normal"
        [badges]="favoriteGenres"
        [actions]="[
          { label: 'Editar Perfil', variant: 'primary', callback: editProfile },
          { label: 'Compartir', variant: 'secondary', callback: shareProfile }
        ]"
      >
      </app-card>

      <!-- Estadísticas adicionales -->
      <div class="profile__stats">
        <div class="profile__stat">
          <span class="profile__stat-value">{{ userProfile.totalReviews }}</span>
          <span class="profile__stat-label">Reseñas</span>
        </div>
        <div class="profile__stat">
          <span class="profile__stat-value">{{ userProfile.totalAlbums }}</span>
          <span class="profile__stat-label">Álbumes</span>
        </div>
      </div>
    </aside>

    <!-- ============================================ -->
    <!-- COLUMNA DERECHA: Tabs + Contenido (2/3)      -->
    <!-- ============================================ -->
    <main class="profile__content">
      <!-- Tabs de navegación -->
      <nav class="profile__tabs">
        <app-button
          [variant]="isTabActive('reviews') ? 'primary' : 'ghost'"
          type="button"
          [fullWidth]="true"
          (click)="setActiveTab('reviews')"
          [class.profile__tab--active]="isTabActive('reviews')"
          class="profile__tab"
        >
          Reseñas
        </app-button>
        <app-button
          [variant]="isTabActive('albums') ? 'primary' : 'ghost'"
          type="button"
          [fullWidth]="true"
          (click)="setActiveTab('albums')"
          [class.profile__tab--active]="isTabActive('albums')"
          class="profile__tab"
        >
          Álbumes
        </app-button>
        <app-button
          variant="ghost"
          type="button"
          [fullWidth]="true"
          [disabled]="true"
          class="profile__tab profile__tab--disabled"
        >
          Canciones
        </app-button>
      </nav>

      <!-- Contenido según tab activo -->
      <div class="profile__tab-content">
        <!-- VISTA: RESEÑAS -->
        @if (activeTab() === 'reviews') {
          <div class="profile__reviews">
            @for (review of reviews(); track review.id) {
              <article class="profile__review-card">
                <div class="profile__review-image">
                  <img [src]="review.albumImageUrl" [alt]="review.albumTitle" />
                </div>
                <div class="profile__review-content">
                  <header class="profile__review-header">
                    <h3 class="profile__review-title">{{ review.albumTitle }}</h3>
                    <p class="profile__review-artist">{{ review.albumArtist }}</p>
                    <div class="profile__review-rating">
                      @for (star of [1,2,3,4,5]; track star) {
                        <span [class]="star <= review.rating ? 'star star--filled' : 'star'">★</span>
                      }
                    </div>
                  </header>
                  <p class="profile__review-text">{{ review.reviewText }}</p>
                  <time class="profile__review-date">{{ review.date }}</time>
                </div>
              </article>
            }
          </div>
        }

        <!-- VISTA: ÁLBUMES -->
        @if (activeTab() === 'albums') {
          <div class="profile__albums">
            @for (album of albums(); track album.id) {
              <app-card
                [title]="album.title"
                [titleLink]="'/album/' + album.id"
                [subtitle]="album.artist"
                [subtitleLink]="'/artist/' + album.artist"
                [imageUrl]="album.imageUrl"
                [imageAlt]="album.title + ' por ' + album.artist"
                variant="vinilo"
                cardType="polaroid"
                hoverEffect="lift"
                (click)="viewAlbum(album.id)"
                class="profile__album-card"
              >
                @if (album.rating) {
                  <div class="profile__album-rating">
                    ⭐ {{ album.rating }}
                  </div>
                }
              </app-card>
            }
          </div>
        }
      </div>
    </main>
  </div>
</main>
