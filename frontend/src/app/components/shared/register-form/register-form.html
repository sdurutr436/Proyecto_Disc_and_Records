<form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form" method="post" novalidate>
  <!-- Fieldset 1: Información de cuenta -->
  <fieldset class="register-form__fieldset">
    <legend class="register-form__legend">Crea tu cuenta</legend>

    <!-- Campo de nombre de usuario - Componente Atómico -->
    <div class="register-form__field">
      <app-form-input
        [control]="usernameControl"
        label="Nombre de usuario"
        type="text"
        id="register-username"
        placeholder="tunombredeusuario"
        helpText="3-20 caracteres (letras, números, guiones bajos)"
        [required]="true"
        [autocomplete]="'username'">
      </app-form-input>
    </div>

    <!-- Campo de correo electrónico - Componente Atómico -->
    <div class="register-form__field">
      <app-form-input
        [control]="emailControl"
        label="Correo electrónico"
        type="email"
        id="register-email"
        placeholder="tu@email.com"
        helpText="Usaremos este correo para tu cuenta"
        [required]="true"
        [autocomplete]="'email'">
      </app-form-input>
    </div>
  </fieldset>

  <!-- Fieldset 2: Seguridad -->
  <fieldset class="register-form__fieldset">
    <legend class="register-form__legend">Seguridad</legend>

    <!-- Campo de contraseña - Componente Atómico -->
    <div class="register-form__field">
      <app-form-input
        [control]="passwordControl"
        label="Contraseña"
        type="password"
        id="register-password"
        placeholder="••••••••"
        helpText="8+ caracteres, mayúscula y especial (!@#$%...)"
        [required]="true"
        [autocomplete]="'new-password'">
      </app-form-input>
    </div>

    <!-- Campo de confirmación de contraseña - Componente Atómico -->
    <div class="register-form__field">
      <app-form-input
        [control]="confirmPasswordControl"
        label="Confirmar contraseña"
        type="password"
        id="register-confirm-password"
        placeholder="••••••••"
        helpText="Vuelve a escribir tu contraseña"
        [required]="true"
        [autocomplete]="'new-password'">
      </app-form-input>

      <!-- Error de password mismatch a nivel de formulario -->
      @if (registerForm.hasError('passwordMismatch') && confirmPasswordControl.touched) {
      <p class="register-form__error" role="alert">
        Las contraseñas no coinciden
      </p>
      }
    </div>
  </fieldset>

  <!-- Botón de submit -->
  <button
    type="submit"
    class="register-form__submit"
    [disabled]="registerForm.invalid || isSubmitting()"
    [attr.aria-busy]="isSubmitting()">
    {{ isSubmitting() ? 'CREANDO CUENTA...' : 'CREAR CUENTA' }}
  </button>

  <!-- Link de inicio de sesión -->
  <div class="register-form__footer">
    <p class="register-form__footer-text">
      ¿Ya tienes cuenta?
      <button
        type="button"
        class="register-form__link-btn"
        (click)="onLogin.emit()">
        Inicia sesión
      </button>
    </p>
  </div>
</form>
