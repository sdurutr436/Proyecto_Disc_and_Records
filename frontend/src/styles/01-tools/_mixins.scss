@use '../00-settings/_variables' as vars;

/* ========================================
   MIXINS DE TIPOGRAFÍA
   ======================================== */

// Mixin para tipografía usando variables
@mixin font-size-line($tipo) {
  @if $tipo == 'h1' {
    font-size: vars.$tamanio-fuente-h1;
    line-height: vars.$altura-linea-h1;
  } @else if $tipo == 'h2' {
    font-size: vars.$tamanio-fuente-h2;
    line-height: vars.$altura-linea-h2;
  } @else if $tipo == 'h3' {
    font-size: vars.$tamanio-fuente-h3;
    line-height: vars.$altura-linea-h3;
  } @else if $tipo == 'h4' {
    font-size: vars.$tamanio-fuente-h4;
    line-height: vars.$altura-linea-h4;
  } @else if $tipo == 'h5' {
    font-size: vars.$tamanio-fuente-h5;
    line-height: vars.$altura-linea-h5;
  } @else if $tipo == 'parrafo' {
    font-size: vars.$tamanio-fuente-parrafo;
    line-height: vars.$altura-linea-parrafo;
  } @else if $tipo == 'texto-pequeno-m' {
    font-size: vars.$tamanio-fuente-texto-pequeno-m;
    line-height: vars.$altura-linea-texto-pequeno-m;
  } @else if $tipo == 'texto-pequeno-s' {
    font-size: vars.$tamanio-fuente-texto-pequeno-s;
    line-height: vars.$altura-linea-texto-pequeno-s;
  } @else if $tipo == 'texto-pequeno-xs' {
    font-size: vars.$tamanio-fuente-texto-pequeno-xs;
    line-height: vars.$altura-linea-texto-pequeno-xs;
  } @else if $tipo == 'leyenda' {
    font-size: vars.$tamanio-fuente-leyenda;
    line-height: vars.$altura-linea-leyenda;
  }
}

/* ========================================
   MIXINS DE TEMA Y COLORES
   ======================================== */

// Mixin para modo oscuro/claro usando variables
@mixin theme-colors($modo: 'light') {
  @if $modo == 'light' {
    background-color: vars.$color-fondo-light;
    color: vars.$color-letra-principal-light;
  } @else if $modo == 'dark' {
    background-color: vars.$color-fondo-oscuro;
    color: vars.$color-letra-principal-dark;
  }
}

// Mixin para alertas accesibles en modo oscuro
@mixin alert-accesible-dark {
  background-color: var(--color-primary);
  color: var(--text-dark);
}

/* ========================================
   MIXINS DE RESPONSIVE
   ======================================== */

// Mixin para media queries usando breakpoints
@mixin respond-to($breakpoint) {
  @if $breakpoint == 'mobile' {
    @media (max-width: vars.$breakpoint-mobile) { @content; }
  } @else if $breakpoint == 'tablet' {
    @media (max-width: vars.$breakpoint-tablet) { @content; }
  } @else if $breakpoint == 'desktop' {
    @media (max-width: vars.$breakpoint-desktop) { @content; }
  } @else if $breakpoint == 'large-desktop' {
    @media (max-width: vars.$breakpoint-large-desktop) { @content; }
  } @else if $breakpoint == 'ultra-wide' {
    @media (max-width: vars.$breakpoint-ultra-wide) { @content; }
  }
}

/* ========================================
   MIXINS NEOBRUTALISTAS - INTERACCIONES
   ======================================== */

// Efecto hover neobrutalista (hundido)
@mixin brutal-hover($shadow-hover: vars.$sombra-brutal-hover, $translate: 0.125rem) {
  &:hover:not(:disabled):not(.button--disabled) {
    box-shadow: $shadow-hover;
    transform: translate($translate, $translate);
  }
}

// Efecto active neobrutalista (más hundido)
@mixin brutal-active($shadow-active: vars.$sombra-brutal-active, $translate: 0.25rem) {
  &:active:not(:disabled):not(.button--disabled) {
    box-shadow: $shadow-active;
    transform: translate($translate, $translate);
  }
}

// Combo hover + active neobrutalista
@mixin brutal-interaction(
  $shadow-hover: vars.$sombra-brutal-hover,
  $shadow-active: vars.$sombra-brutal-active
) {
  @include brutal-hover($shadow-hover);
  @include brutal-active($shadow-active);
}

// Efecto hover inverso (se eleva)
@mixin brutal-hover-lift($shadow-lift: vars.$sombra-brutal-xs-plus) {
  &:hover:not(:disabled) {
    transform: translate(-0.0625rem, -0.0625rem);
    box-shadow: $shadow-lift;
  }
}

/* ========================================
   MIXINS DE ESTADOS
   ======================================== */

// Estado disabled genérico
@mixin state-disabled($opacity: 0.5) {
  opacity: $opacity;
  cursor: not-allowed;
  pointer-events: none;
}

// Estado disabled para campos de formulario
@mixin field-disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background-color: var(--bg-secondary);

  &:hover {
    box-shadow: vars.$sombra-brutal-s;
    transform: none;
  }
}

// Focus visible accesible
@mixin focus-visible($color: var(--color-accent), $offset: 0.125rem) {
  &:focus-visible {
    outline: 0.1875rem solid $color;
    outline-offset: $offset;
  }
}

// Focus para campos de formulario
@mixin field-focus($color: var(--color-primary)) {
  &:focus {
    outline: none;
    border-color: $color;
    box-shadow: vars.$sombra-brutal-xs-plus;
  }
}

/* ========================================
   MIXINS DE FORMULARIOS
   ======================================== */

// Contenedor de campo de formulario
@mixin form-field-wrapper {
  display: flex;
  flex-direction: column;
  gap: vars.$espaciado-xs;
  width: 100%;
}

// Label de formulario
@mixin form-label {
  font-size: vars.$tamanio-fuente-texto-pequeno-s;
  font-weight: 500;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 0.25rem;
}

// Indicador de campo requerido
@mixin form-required-indicator {
  color: vars.$color-error;
  font-weight: 600;
  font-size: 1.125rem;
  line-height: 1;
}

// Campo de formulario base (input, select, textarea)
@mixin form-field-base {
  width: 100%;
  padding: vars.$espaciado-xs vars.$espaciado-s;
  font-family: vars.$fuente-principal;
  font-size: vars.$tamanio-fuente-parrafo;
  color: var(--text-primary);
  background-color: var(--bg-primary);
  border: vars.$borde-brutal-medium;
  border-radius: vars.$radio-m;
  box-shadow: vars.$sombra-brutal-s;
  transition: all vars.$transicion-rapida;
  outline: none;

  &::placeholder {
    color: var(--text-secondary);
  }

  &:focus {
    border-color: var(--color-primary);
    box-shadow: vars.$sombra-brutal-primario-light;
  }

  @include brutal-hover-lift;

  &:disabled {
    @include field-disabled;
  }
}

// Estado de error para campos
@mixin form-field-error {
  border-color: vars.$color-error;
  box-shadow: vars.$sombra-brutal-error;

  &:focus {
    box-shadow: vars.$sombra-brutal-error;
  }
}

// Mensaje de error con icono (altura fija para evitar resize del formulario)
@mixin form-error-message {
  font-size: vars.$tamanio-fuente-texto-pequeno-xs;
  color: vars.$color-error;
  font-weight: 500;
  display: flex;
  align-items: center;
  gap: 0.25rem;
  min-height: 1.5em; /* Altura fija para evitar saltos */
  margin: 0;

  &::before {
    content: '⚠';
    font-size: 1rem;
  }
}

// Texto de ayuda/hint (altura fija para evitar resize del formulario)
@mixin form-hint {
  font-size: vars.$tamanio-fuente-texto-pequeno-xs;
  color: var(--text-secondary);
  font-style: italic;
  min-height: 1.5em; /* Altura fija para evitar saltos */
  margin: 0;
  display: flex;
  align-items: center;
}

// Contenedor de formulario completo (wrapper externo)
@mixin form-container($max-width: vars.$ancho-maximo-formulario) {
  @include flex-column(vars.$espaciado-m);
  max-width: $max-width;
  margin: 0 auto;
  padding: vars.$espaciado-l;
  @include brutal-box(var(--bg-primary), vars.$borde-brutal-thick);
}

// Fieldset de formulario
@mixin form-fieldset {
  border: vars.$borde-brutal-thin;
  border-radius: vars.$radio-xs;
  padding: vars.$espaciado-m;
  margin: 0;
  @include flex-column(vars.$espaciado-m);
  background-color: var(--bg-secondary);
}

// Legend de formulario
@mixin form-legend {
  font-size: vars.$tamanio-fuente-h4;
  font-weight: 600;
  color: var(--text-primary);
  padding: 0 vars.$espaciado-xs;
  @include text-uppercase;
}

// Botón submit de formulario
@mixin form-submit-button {
  font-family: vars.$fuente-principal;
  font-size: vars.$tamanio-fuente-parrafo;
  font-weight: 600;
  padding: vars.$espaciado-s vars.$espaciado-m;
  border: vars.$borde-brutal-medium;
  border-radius: vars.$radio-s;
  background-color: var(--color-primary);
  color: var(--text-dark);
  box-shadow: vars.$sombra-brutal-s;
  transition: all vars.$transicion-rapida;
  cursor: pointer;
  @include text-uppercase;
  width: 100%;

  @include brutal-interaction;
  @include focus-visible;

  &:disabled {
    @include state-disabled(0.6);
    box-shadow: vars.$sombra-brutal-s;
    transform: none;
  }
}

/* ========================================
   MIXINS DE LAYOUT
   ======================================== */

// Contenedor flex columna
@mixin flex-column($gap: vars.$espaciado-xs) {
  display: flex;
  flex-direction: column;
  gap: $gap;
}

// Contenedor flex fila
@mixin flex-row($gap: vars.$espaciado-xs) {
  display: flex;
  flex-direction: row;
  gap: $gap;
}

// Centrado flex
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

// Contenedor con ancho máximo centrado
@mixin container-centered($max-width: vars.$ancho-maximo-contenedor) {
  max-width: $max-width;
  margin: 0 auto;
}

// Elemento sticky
@mixin sticky-top($z-index: vars.$z-sticky) {
  position: sticky;
  top: 0;
  z-index: $z-index;
}

/* ========================================
   MIXINS DE TEXTO
   ======================================== */

// Texto truncado con ellipsis
@mixin text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

// Texto uppercase con tracking
@mixin text-uppercase {
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

/* ========================================
   MIXINS DE COMPONENTES NEOBRUTALISTAS
   ======================================== */

// Caja neobrutalista base
@mixin brutal-box(
  $bg: var(--bg-secondary),
  $border: vars.$borde-brutal-thick,
  $shadow: vars.$sombra-brutal-s,
  $radius: vars.$radio-l
) {
  background-color: $bg;
  border: $border;
  border-radius: $radius;
  box-shadow: $shadow;
}

// Botón base neobrutalista
@mixin brutal-button-base {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: vars.$espaciado-xs;
  font-family: vars.$fuente-principal;
  font-weight: 600;
  @include text-uppercase;
  text-decoration: none;
  cursor: pointer;
  border: vars.$borde-brutal-medium;
  border-radius: vars.$radio-pildora;
  transition: all vars.$transicion-rapida;
  white-space: nowrap;
  box-sizing: border-box;
  @include focus-visible;
}

// Badge neobrutalista
@mixin brutal-badge($bg: var(--color-primary)) {
  display: inline-block;
  padding: vars.$espaciado-tiny vars.$espaciado-xs;
  font-size: vars.$tamanio-fuente-texto-pequeno-xs;
  font-weight: 600;
  text-transform: uppercase;
  background-color: $bg;
  color: var(--text-dark);
  border: vars.$borde-brutal-thin;
  border-radius: vars.$radio-xs;
  box-shadow: vars.$sombra-brutal-xs;
  line-height: 1;
}

/* ========================================
   MIXINS DE HOST (para Angular components)
   ======================================== */

// Host display block (evita overflow en flex parents)
@mixin host-block {
  display: block;
  width: 100%;
  max-width: 100%;
  min-width: 0;
}

/* ========================================
   MIXINS DE OVERLAY Y MODALES
   ======================================== */

// Overlay fullscreen con backdrop
@mixin overlay-backdrop($z-index: vars.$z-overlay, $bg-opacity: 0.7) {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, $bg-opacity);
  @include flex-center;
  z-index: $z-index;
}

// Posición fixed en esquina
@mixin position-fixed($position: 'top-right', $offset: vars.$espaciado-m) {
  position: fixed;
  z-index: vars.$z-popover;

  @if $position == 'top-right' {
    top: $offset;
    right: $offset;
  } @else if $position == 'top-left' {
    top: $offset;
    left: $offset;
  } @else if $position == 'bottom-right' {
    bottom: $offset;
    right: $offset;
  } @else if $position == 'bottom-left' {
    bottom: $offset;
    left: $offset;
  }
}

/* ========================================
   MIXINS DE ICONOS Y ELEMENTOS FLEXIBLES
   ======================================== */

// Contenedor de icono flex
@mixin icon-container($size: 1.5rem) {
  flex-shrink: 0;
  width: $size;
  height: $size;
  @include flex-center;
  font-size: $size * 0.8;
  font-weight: 700;
  line-height: 1;
}

// Botón de cerrar/dismiss
@mixin dismiss-button($size: 1.5rem) {
  @include icon-container($size);
  background: transparent;
  border: none;
  cursor: pointer;
  padding: 0;
  opacity: 0.7;
  color: inherit;
  transition: all vars.$transicion-rapida;

  &:hover {
    opacity: 1;
    transform: scale(1.1);
  }

  &:focus {
    outline: 0.125rem solid currentColor;
    outline-offset: 0.125rem;
  }
}

/* ========================================
   MIXINS DE COLORES DE ESTADO (para alertas/notifications)
   ======================================== */

// Colores de estado para componentes tipo alerta
@mixin state-colors($type: 'info') {
  @if $type == 'success' {
    background-color: vars.$color-exito;
    border-color: var(--border-color);
    color: var(--text-dark);
  } @else if $type == 'error' {
    background-color: vars.$color-error;
    border-color: var(--border-color);
    color: var(--text-white);
  } @else if $type == 'warning' {
    background-color: vars.$color-advertencia-light;
    border-color: var(--border-color);
    color: var(--text-dark);
  } @else if $type == 'info' {
    background-color: vars.$color-informacion;
    border-color: var(--border-color);
    color: var(--text-white);
  }
}

/* ========================================
   MIXINS DE ANIMACIONES COMUNES
   ======================================== */

// Fade in animation
@mixin animation-fade-in($duration: 0.3s) {
  animation: fadeIn $duration ease;

  @at-root {
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  }
}

// Slide up animation
@mixin animation-slide-up($duration: 0.3s, $distance: 2rem) {
  animation: slideUp $duration cubic-bezier(0.4, 0, 0.2, 1);

  @at-root {
    @keyframes slideUp {
      from {
        transform: translateY($distance);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
  }
}

/* ========================================
   MIXINS DE SCROLLBAR OCULTO
   ======================================== */

// Ocultar scrollbar manteniendo funcionalidad
@mixin hide-scrollbar {
  scrollbar-width: none; // Firefox
  -ms-overflow-style: none; // IE/Edge

  &::-webkit-scrollbar {
    display: none; // Chrome/Safari
  }
}

/* ========================================
   MIXINS DE MEDIA QUERIES ESPECÍFICOS
   ======================================== */

// Media query para tablet (entre mobile y desktop)
@mixin tablet-only {
  @media (min-width: vars.$breakpoint-tablet) and (max-width: #{vars.$breakpoint-desktop - 1px}) {
    @content;
  }
}

// Media query móvil (menor que tablet)
@mixin mobile-down {
  @media (max-width: #{vars.$breakpoint-tablet - 1px}) {
    @content;
  }
}

// Media query móvil pequeño (menor que 480px) - para textos y padding más reducidos
@mixin mobile-sm-down {
  @media (max-width: #{vars.$breakpoint-mobile-sm - 1px}) {
    @content;
  }
}

// Media query móvil muy pequeño (320px-480px)
@mixin mobile-xs {
  @media (max-width: vars.$breakpoint-mobile-sm) {
    @content;
  }
}

// Media query desktop hacia arriba
@mixin desktop-up {
  @media (min-width: vars.$breakpoint-desktop) {
    @content;
  }
}

/* ========================================
   MIXINS DE TIPOGRAFÍA RESPONSIVE MÓVIL
   ======================================== */

// Tipografía reducida para móviles pequeños
@mixin mobile-text-size($size: 'normal') {
  @if $size == 'body' {
    font-size: vars.$tamanio-fuente-texto-pequeno-s; // 14px en lugar de 16px
    line-height: vars.$altura-linea-texto-pequeno-s;
  } @else if $size == 'small' {
    font-size: vars.$tamanio-fuente-texto-pequeno-xs; // 12px
    line-height: vars.$altura-linea-texto-pequeno-xs;
  } @else if $size == 'heading' {
    font-size: vars.$tamanio-fuente-h4; // 16px para títulos en móvil pequeño
    line-height: vars.$altura-linea-h4;
  }
}

// Contenedor edge-to-edge para móvil (sin padding lateral)
@mixin mobile-full-width {
  @include mobile-sm-down {
    padding-left: vars.$espaciado-xs;
    padding-right: vars.$espaciado-xs;
    margin-left: 0;
    margin-right: 0;
    border-radius: 0;
  }
}

// Sección que se estira al máximo en móvil
@mixin section-mobile-stretch {
  @include mobile-down {
    padding-left: vars.$espaciado-s;
    padding-right: vars.$espaciado-s;
  }

  @include mobile-sm-down {
    padding-left: vars.$espaciado-xs;
    padding-right: vars.$espaciado-xs;
    border-left: none;
    border-right: none;
    border-radius: 0;
  }
}
